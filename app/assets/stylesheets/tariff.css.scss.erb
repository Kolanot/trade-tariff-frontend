/* global variables */

$token-width: 27;
$token-padding: 5;
$token-space: $token-width + $token-padding; /* Uses above values */
$top-level-padding: 10;

$top-section-blue: #EAF3F8;

/* end global variables */

/* variables local to commodities */

$commodity-padding: $token-width;
$expand-arrow-width: 9;
$expand-arrow-space: 9 + $token-padding;

/* end variables local to commodities */

/* conversion functions */

@function em($target-px, $current-px) {
  @return $target-px * (1 / $current-px) * 1em;
}

@function px($value) {
  @return $value * 1px;
}

/* end conversion functions */

/* mixins */

@mixin contain-float {
  zoom: 1;

  &:after {
    content: ".";
    display: block;
    height: 0;
    clear: both;
    visibility: hidden;
  }
}

/* Styles inherited from static */

@mixin table {
  border-collapse: collapse;
  border-spacing: 0;

  caption {
    text-align:left;
    font-weight: 300;
    margin-bottom: 0.5em;
    font-size:em(19, 16);
    padding-left:0em;
  }

  th,
  td {
    vertical-align: top;
    line-height: 1.3em;
    padding: 0.7em 0.75em 0.7em 0.75em;
  }

  tr:nth-child(even) td {
    background-color: #fff;
  }

  td {
    background: #fafafa;
    border:dotted 1px #bbb;
  }

  th {
    line-height:1.25em;
    text-align: left;
    color:#000;
    font-weight:normal;
    background-color: #e1e8e8;
    border:solid 1px #bbb;
  }
  th.legal-act {
    width:6.66666664em;
  }
  td small{
    font-size:1em;
  }
}

// the tab panes associated with these tabs require the following styles:
// border-top:solid 1px #C9D0D0;

@mixin tabs($side-padding) {
    padding: 0 0 0 px($side-padding);
    position: relative;

  ol,
  ul {
    background-color: #C9D0D0;
    float: left;
    list-style: none;
    margin: 0;
    padding: 0;
    position: relative;
    z-index: 5;
  }
  .lte-ie8 & ol,
  .lte-ie8 & ul {
    _overflow: hidden;
    _padding: 1px 1px 0 0;
  }

  ol li,
  ul li {
    float: left;
  }
  .lte-ie8 & ol li,
  .lte-ie8 & ul li {
    _width: 7.5em;
  }

  li a {
    background-color: #E1E8E8;
    display: block;
    height: 2.25em;
    line-height: 2.25em;
    margin-left: 1px;
    padding: 0 1em 0 0.75em;
    position: relative;
    text-align: center;
    text-decoration: none;
    top: 0;
  }
  .lte-ie8 & li a {
    _background-image: none;
    _padding: 0 0.5em;
  }

  li:first-child a {
    border-left: solid 1px #E1E8E8;
    margin-left: 0;
  }

  li a:hover {
    background-color: #97C5E5;
    color: inherit;
  }

  li.active a {
    background-color: #fff;
    border: solid 1px #C9D0D0;
    border-bottom: solid 1px #fff;
    color: #000;
    margin: -1px -1px -1px 0;
    position: relative;
    z-index: 5;
  }
  .lte-ie8 & li.active a {
    _bottom: -1px;
  }

  li.active a:hover {
    background-color: #fff;
    color: #2E8ACA;
  }
}

/* Mixins specific to tariff */

@mixin tariff-identifier {
  color:#000;
  font-family:"Helvetica Neue", Arial, Helvetica, sans-serif;
}

@mixin tariff-identifier-reset {
  color:#333;
  font-family:"NTA", "Helvetica Neue", Arial, Helvetica, sans-serif;
}

@mixin underlined-section-list {
  dt,
  dd {
    border-top:1px solid #eee;
  }

  dt:nth-child(1),
  dd:nth-child(2) {
    border-top:none;
    padding-top:1px;
  }
}

@mixin underlined-ordered-list {
  li {
    border-top:1px solid #eee;
  }

  li:nth-child(1) {
    border-top:none;
    padding-top:1px;
  }
}

@mixin underlined-token-list {
  dt,
  dl dt:nth-child(1) {
    border-top:1px solid #fff;
  }

  dd,
  dl dd:nth-child(2) {
    border-top:1px solid #eee;
  }

  dt:nth-child(1),
  dd:nth-child(2) {
    border-top:none;
    padding-top:1px;
  }
}

// selected sections have consistent styling except for their spacing from the left-side
// this is therefore left as a variable value

@mixin selected-section($side-padding) {
  margin: 0 px(-1 * $top-level-padding) 0 px(-1 * ($side-padding + $token-width + $token-padding));
  padding: px($top-level-padding) px($top-level-padding) px($top-level-padding) px($side-padding + $token-width + $token-padding);
  background: #fff;
}

/* end mixins */

.visuallyhidden {
  height:1px;
  width:1px;
  overflow:hidden;
}

mark {
  color:inherit;
  background:none;
}

.tariff header.page-header hgroup,
.tariff .article-container {
  margin-right:0;
}

.tariff .article-container {
  padding-bottom:2em;
}

.tariff header.page-header hgroup{
  padding-bottom:0;
  padding-right:px($top-level-padding);
}

.tariff header.page-header hgroup h1{
  font-size:em(24, 16);
  padding:em(16, 24) em($top-level-padding, 24) 0 em(73, 24);
}

.tariff header.page-header hgroup h1 span {
  font-size:em(14, 24);
}

.tariff header.page-header hgroup p,
.tariff header.page-header hgroup form {
  font-size:em(14, 16);
  text-align:right;
  margin:em(-23, 14) 0 0;
  padding:0 0 em(16, 14);
  background:none;
  line-height:2em;

  &.sections-context {
    margin-right:7.5539149%;
  }
}


.tariff header.page-header hgroup p {
  a {
    font-size:em(14, 16);
    display:inline-block;
    margin-left:1em;
  }
}

.commodities .chapter-code,
.commodities .heading-code {
  border-right:#fff solid 2px;
}

.chapter-code {
  background:#D4D5E7;
}

.heading-code {
  background:#B6D7EB;
}

article table {
    @include table;
    width:106.71875%; /* override for static styles */
    margin:em(32, 16) -3.4375% 0; /* override for static styles */

  /* ignore caption */
  thead,
  tbody {
    font-size:em(12, 16);
  }

  .tab-content & p {
    margin:0;
    font-size:1em;
  }

  /* Expanding table-cell content */

  dl {
    padding:0;
    background:none;
  }

  dt {
    @include tariff-identifier-reset;
    width:auto;
    position:static;
    float:none;
    text-align:left;
    cursor:pointer;
  }

  dd {
    float:none;
    padding-left:0;
  }

  dt.has_children {
    padding-left: px($expand-arrow-space);
    margin-left:-6px;
    background-image: url(<%= asset_path "expand-collapse-transparent.png" %>);
    background-position: 0px 2px;
    background-repeat: no-repeat;
  }

  dt.open {
    background-position:0 -89px;
  }

  ul {
    list-style:none;
  }

  li {
    font-size:1em;
    padding-left:0;
  }

  a[rel="external"]:after {
    content:"";
    margin-left:0;
    margin-right:0;
  }
}

article.tariff {
  font-size:em(14, 16);
  min-height:34em; /* right column needs this to show all content */
  _height:34em;
}

.tariff {
  a {
    text-decoration:none;

    &:hover,
    &:focus {
      color:#2e8aca
    }
  }

  p {
    font-size:1em;
    padding-left:8.4375%;
    padding-right:8.4375%;
    margin-left:px($top-level-padding);
    margin-right:px($top-level-padding);
  }

  .inner {
    padding: 0;
  }
}

.help-notice {
  padding:0.25em 1em 0.25em 1em;
}

.tariff-search {
  text-align:right;
  font-size:em(14, 16);
  line-height:2em;
  background:#fff;
  height:2em;
  padding:0.5em px($top-level-padding) 0.5em em(81, 14);
  
  a {
    float:left;
  }

  p {
    display:inline;
    padding:0 3em 0 0;
    margin:0;
    text-align:left;

    a {
      font-size:0.85em;
      float:none;
    }
  }
}

.sections-context {
  padding-right:em(81, 14);
}

#commodity_search_q {
  width: 8em;
}

#ui-datepicker-container {
  position:relative;
  height:0;
  width:auto;
  overflow:visible;
}

.ui-datepicker {
  background:#fff;
  border:1px solid #eee;
  padding:px($top-level-padding);
  display:none;
  position:absolute;
  right:0;
  z-index:2;
  text-align:left;
  line-height:1.5;

  .ui-datepicker-header {
    padding:0 px($token-padding + 16);
    /* IE fix */
    *width:1px;
  }

  .ui-datepicker-header a {
    position:absolute;
    top:10px;
    display:block;
    margin:0;
  }

  .ui-widget-header .ui-icon {
    background-image: url(<%= asset_path "ui-icons_222222_256x240.png" %>);
  }

  .ui-datepicker-prev {
    left:10px;
  }

  .ui-datepicker-next {
    right:10px;
  }

  th {
    width:1.7142857em;
  }

  td {
    text-align:center;
  }

  td .ui-state-default {
    background:none;
    text-decoration:none;
  }

  td a {
    display:block;
  }

  .ui-state-highlight,
  .ui-widget-content .ui-state-highlight,
  .ui-widget-header .ui-state-highlight {
    border-width:3px;
  }

  iframe.ui-datepicker-cover { display:none;  }
}

#index {
  list-style-type:upper-roman
}

article dl {
  padding: px($top-level-padding) px($top-level-padding) 0 px($top-level-padding);
  margin: 0;
  background: $top-section-blue;
  position: relative;
  zoom:1;

  dl {
    @include contain-float;
    margin-left:px($token-width - $top-level-padding);
    padding-top:0px;
  }
}

article dt {
  float: left;
  width: px($token-width);
  clear: left;
  text-align: center;
  display: block;
  font-size: 1em;
  position: absolute;
  left: 0;
  font-weight:normal;
  margin-bottom:0; /* reset of static */

  &.section-number {
    position:static;
    width:auto;
    margin-right:px($token-padding);
    margin-left:-1 * px($token-padding);
  }
}

dl.chapters,
dl.tariff-fragments .chapter-headings {
  @include underlined-token-list;
}

dl.chapters dt,
dl.tariff-fragments .chapter-headings dt {
  border-top:solid 1px #fff; /* offset the border-bottom on the token */
}

dl.tariff-fragments {
  padding: 0;
  margin-left: -1px * $token-space;

  dt {
    @include tariff-identifier;
  }

  dd {
    float: none;
    padding-left: px($token-space);
    margin: 0;
  }

  dl {
    position: relative;
    margin-left:px(-1 * $token-padding);
    padding:0;
  }
}

article dd {
  float: left;
  display: block;
  margin: 0;
  padding-left: px($token-space - $top-level-padding);

  // this is so the children of this are cleared out left as the
  // internal content is pushed over by the float
  &.section-title {
    width: auto;
    float: none;
    margin-bottom: 0;
  }
}

dl h1 {
  font-size: 100%;
  margin: 0;
  padding-bottom:px($top-level-padding);
  line-height: 1.5em;
  color: #333;
}
dl h1 .identifier {
  font-weight:400;
}

/* sections */

p.sections-intro {
  padding-left:0.5em;
  padding-right:1em;
}

dl.sections {
  @include underlined-section-list;
  background:#fff;
  padding-left:8.4375%;
  padding-right:8.4375%;

  dt {
    position:static;
    display:inline;
    width:16%;
    text-align:left;
    font-weight:normal;
  }
}

dl.sections dd {
  width:84%;
  padding-left:0px;
}

/* chapters and chapter headings */

article.chapters dt {
  position:static;
  width:auto;
  margin-right:px($token-padding);
}

article.chapters dl.tariff-fragments dt {
  width:px($token-width);
}

dl.tariff-fragments dl.chapter-headings,
dl.chapters,
p.chapters-intro {
  @include selected-section(0);
}

dl.chapters {
  @include underlined-token-list;
}

dl.chapter-headings dt,
dl.chapters dt {
  left:px($token-space);
}

dl.chapter-headings {
  
  dt.heading-subtitle {
    display:block;
    float:none;
    position:static;
    padding-top:px($top-level-padding / 2);
    margin:0;
    width:auto;
    text-align:left;
    font-size:1em;
    font-weight:normal;
    font-family:"NTA", "Helvetica Neue", Arial, Helvetica, sans-serif;
  }

  dd.subtitle-description {
    padding-left:0;
    border-top:none;
  }
}
.chapter-notes {
  padding:0 px($top-level-padding) 0;
  width:auto;
  font-size:1em; /* 14px */

  h2,
  li {
    font-size:1em; /* 14px */
    margin-bottom:1em;
  }

  ol {
    margin-left:0;
    padding-left:em(($token-space - $top-level-padding), 14);
  }

  ol li {
    list-style-type:decimal;
    padding-left:0;
    margin-bottom:1em;
  }

  ol ol {
    padding-left:0;
    margin-top:1em;
  }

  ol ol li {
    list-style-type:lower-alpha;
  }
}

.tariff ul,
.tariff li,
.tariff ul ul {
  list-style:none;
  list-style-image:none;
}

ul.commodities {
  @include selected-section($commodity-padding);
  @include underlined-ordered-list;
  @include contain-float;
  position:relative; /* to give z-index */

  li {
    display: block;
    margin: 0;
    padding: 0;
    position:relative;
    @include contain-float;

    a {
      margin:0;
      text-decoration:none;
    }

    span {
      font-size: 0.85em;
      float: left;
      display: block;

      &.description {
        padding-right:8.6em;
        margin-right:px($token-space);
      }

      &.identifier {
        @include tariff-identifier;
        font-weight:normal;
        border: 0;
        padding: 0 em(7, 14) 0 0;
        float:right;
        background:#B5DEDB;
        width:8.6em;
        text-align:right;

        span {
          font-size:1em;
          text-align:left;
          padding:0 em(5, 12) 0 em(7, 14);
        }

        .heading-code {
        }
      }

      &.rate {
        padding-right:em($token-padding, 14);
        width:em(60, 14);
        text-align:right;
        position:absolute;
        right:0;
        bottom:0;
      }
    }

    a {
      display: block;
      @include contain-float;
    }
  }

  li:last-child {
    border-bottom: 0;
  }

  ul {
    margin: 0;
    padding-left: em($token-width, 14);
    clear: both;
  }
}

dl.tariff-fragments dl.commodities {
  margin-left:px($token-width);
  padding-bottom:px($top-level-padding);

  dt {
    @include tariff-identifier-reset;
    width:auto;
    float:none;
    position:static;
    text-align:left;
    font-weight:normal;
    font-family:"NTA", "Helvetica Neue", Arial, Helvetica, sans-serif;
  }

  span {
    &.identifier {
      float:left;
      @include tariff-identifier;
      padding: 0 em(5, 14) 0 em(7, 14);
      margin-right:5px;
      background:#B5DEDB;
    }

    &.description {
      overflow:hidden;
      display:block;
    }
  }
}

dl.tariff-fragments dd.declarable {
  margin-bottom:px($top-level-padding);
}

.nav-tabs,
.tab-content {
  font-size:em(16, 14);
}

.nav-tabs {
  @include contain-float;
  background:$top-section-blue;
  @include tabs($token-width);

  li {
    padding:0;
    margin:0;
    font-size:1em;
  }
}

.tab-content {
  .tab-pane {
    border-top:solid 1px #C9D0D0;
    clear:both;
  }

  .inner {
    padding:0em 2.5em 1em;
  }

  h1.visuallyhidden + h2 {
    margin-top:2em;
  }

  p {
    font-size:em(19, 16);
    padding:0;
    margin-left:0;
    margin-right:0;
  }

  em {
    font-style:normal;
    font-weight:bold;
  }

  nav {
    margin:1em (-1 * em(22, 16)) 0; /* override for static styles */
  }
}

ul.tree-controls {
  font-size:0.85em;
  margin-left:px($top-level-padding);
  padding:0;
}

ul.tree-controls li {
  display:inline;
  padding-right:px($top-level-padding);
}

.conditions article,
.footnotes article {
  min-height:0;
}
.conditions + .return-to-top,
.footnotes + .return-to-top {
  clear:both;
  padding-top:2em;
}

/* Popup lightbox */

#popup.tariff-info {
  top: 12px;
  height:auto;
  _width:720px;
  max-width: 720px;
  padding:0;
  zoom:1;

  .info-content,
  article {
    padding: 0 px($top-level-padding) px($top-level-padding) px($top-level-padding);
  }

  .info-content {
    background-color: #f2f2f2;
    padding: 2.4em px($top-level-padding) px($top-level-padding) px($top-level-padding);
  }

  /* resets for article styles */
  article {
    float:none;
    margin:0;
    width:auto;
    height:auto;
    min-height:0;

    padding-bottom:3em;
    overflow:hidden;
  }

  .close {
    padding:0.2em px($top-level-padding) 0.2em 0.5em;
    text-align:right;

    a {
      background-position:0.6875em 0.6875em;
      display:inline-block;
      text-indent:99999px;
      overflow:hidden;
    }
  }

  table {
    margin:0;
    width:100%;
  }
}

/* Search */

/* variables specific to search */

$results-padding: 81 - $top-level-padding;

/* end variables specific to search */

h1.search-heading,
article.search-results {
  padding: px($top-level-padding);
  width:auto;
}

h1.search-heading {
  background: $top-section-blue;
  color:#000;
  font-size:1em;
  font-weight:normal;
}

article.search-results {
  font-size:em(14, 16);
  padding-bottom:2em;

  h2 {
    clear:both;
    font-size:em(20, 16);
    margin-left:px($results-padding);
  }

  dl {
    position:relative;
    background:none;
    padding:0;
    @include underlined-token-list;
  }

  .results-subset {
    margin-left:px($results-padding);
    border-bottom:1px solid #eee;

    li {
       @include underlined-ordered-list;
       font-size:1em; /* 14px */
       list-style:none;
       margin-left:-1 * px($token-padding);
    }
  }

  .sections {
    @include underlined-section-list;

    dt {
      width:15%;
      float:left;
      padding-right:0px;
      margin-left:0;
      font-family:"NTA", "Helvetica Neue", Arial, Helvetica, sans-serif;
    }

    dd {
      width:84%;
      padding-left:0;
      overflow:hidden;
    }
  }

  dt {
    @include tariff-identifier;
  }

  dd {
    padding-left:px($token-space);
    float:none;
  }

  dd a {
    text-decoration:none;
    display:block;
  }

  dl dl {
    margin-left:-1 * px($token-padding);
  }
}

.date-filter-search {
  line-height:2em;

  input {
    margin-right:1em;
  }

  .calendar-icon {
    vertical-align:top;
    display:inline-block;
    margin-right:1em;
    cursor:pointer;

    img {
      display:block;
    }
  }

  .button {
    vertical-align:middle;
  }
}

.related-module {
  background: #fff;
  font-size:em(14, 16);
  padding:1em;
  @include contain-float;

  a {
  }

  address{
    float:left;
    width:50%;
    text-align:center;
    font-style:normal;

    a {
      margin-bottom: 0;
    }
  
    .tel{
      display:inline-block;
      margin-left:0.5em;
      color: #000;
      font-family:"NTA", "Helvetica Neue", Arial, Helvetica, sans-serif;
    }
  }
}

#loader {
  position:fixed;
  top:45%;
  width:100%;
  height:50px;
  text-align:center;
  z-index:99999;
}

#loader img {
  margin:0 auto;
  width:50px;
  height:50px;
}

.js-enabled {
  li.has_children {

  }

  li.open {
    background-position: 0 -100px;
  }

  li.has_children .description {
    padding-left: px($expand-arrow-space);
    margin-left: -1 * px($expand-arrow-space);
    background-image: url(<%= asset_path "expand-collapse-transparent.png" %>);
    background-position: 0 6px;
    background-repeat: no-repeat;
    cursor:pointer;
    position:relative; /* to give z-index */
  }

  li.has_children a .description {
    margin-left: 0;
  }
  li.has_children .open {
    background-position:0 -385px;
  }

  li.has_children a .description {
    padding-left:0;
    background:none;
  }

  .return-to-top {
    display:none;
  }

  .conditions,
  .footnotes {
    display:none; 
    clear:both;
  }

  .date-filter-search {
    display:none;
  }

  .tooltip-description {
    display:none;
    position:absolute;
    width:200px;
    padding:px($top-level-padding);
    z-index:1;
    font-size:em(14, 16);
    background:#fff;
    border:solid 1px #bbb;

    p {
      margin:0;
      padding:$top-level-padding;
    }
  }
}
