/* global variables */

$token-width: 26; /* 25px width + 1px border */
$token-padding: 5;
$token-space: $token-width + $token-padding; /* Uses above values */
$top-level-padding: 10;

$top-section-grey: #f8f7ee;

/* end global variables */

/* conversion functions */

@function em($target, $current) {
  @return $target * (1 / $current) * 1em;
}

@function px($value) {
  @return $value * 1px;
}

/* end conversion functions */

/* mixins */

@mixin contain-float {
  zoom: 1;

  &:after {
    content: ".";
    display: block;
    height: 0;
    clear: both;
    visibility: hidden;
  }
}

/* Styles inherited from static */

@mixin table {
  border-collapse: collapse;
  border-spacing: 0;
  
  caption {
    text-align:left;
    font-weight: 300;
    margin-bottom: 0.5em;
    font-size:1.16em; /* 19px */
    padding-left:1em;
  }
  
  th,
  td {
    vertical-align: top;
    line-height: 1.3em;
    padding: 0.7em 0.5em 0.7em 1em;
  }
  
  tr:nth-child(even) td {
    background-color: #fff;
  }
  
  td {
    background: #fafafa;
    border:dotted 1px #bbb;
  }
  
  th {  
    line-height:1.25em;
    text-align: left;
    color:#000;
    font-weight:normal;
    background-color: #e1e8e8;
    border:solid 1px #bbb;
  }
  td small{
    font-size:1em;
  }
}

// the tab panes associated with these tabs require the following styles:
// border-top:solid 1px #C9D0D0;

@mixin tabs($side-padding) {
    padding: 0 0 0 $side-padding;
    position: relative;
  
  ol,
  ul {
    background-color: #C9D0D0;
    float: left;
    list-style: none;
    margin: 0;
    padding: 0;
    position: relative;
    z-index: 5;
  }
  .lte-ie8 & ol,
  .lte-ie8 & ul {
    _overflow: hidden;
    _padding: 1px 1px 0 0;
  }
  
  ol li,
  ul li {
    float: left;
  }
  .lte-ie8 & ol li,
  .lte-ie8 & ul li {
    _width: 7.5em;
  }
  
  li a {
    background-color: #E1E8E8;
    display: block;
    height: 2.25em;
    line-height: 2.25em;
    margin-left: 1px;
    padding: 0 1em 0 0.75em;
    position: relative;
    text-align: center;
    text-decoration: none;
    top: 0;
  }
  .lte-ie8 & li a {
    _background-image: none;
    _padding: 0 0.5em;
  }
  
  li:first-child a {
    border-left: solid 1px #E1E8E8;
    margin-left: 0;
  }
  
  li a:hover {
    background-color: #97C5E5;
    color: inherit;
  }
  
  li.active a {
    background-color: #fff;
    border: solid 1px #C9D0D0;
    border-bottom: solid 1px #fff;
    color: #000;
    margin: -1px -1px -1px 0;
    position: relative;
    z-index: 5;
  }
  .lte-ie8 & li.active a {
    _bottom: -1px;
  }
  
  li.active a:hover {
    background-color: #fff;
    color: #2E8ACA;
  }
}

// selected sections have consistent styling except for their spacing from the left-side
// this is therefore left as a variable value

@mixin selected-section($side-padding) {
  margin: 0 px(-1 * $top-level-padding) 0 px(-1 * $side-padding);
  padding: px($top-level-padding) px($top-level-padding) px($top-level-padding) px($side-padding);
  background: #fff;
  
  li,
  dd {
    padding-top:0px;
    border-top:1px solid #eee;
  }
  
  li:first-child,
  dd:nth-child(2) {
    padding-top:1px;
    border-top:none;
  }
}

/* Mixins specific to tariff */

@mixin tariff-identifier {
  background: #CCE0D6;
  border-top: solid 1px #7FB299;
  border-right: solid 1px #7FB299;
}

@mixin tariff-identifier-reset {
  background: none;
  border-top: none;
  border-right: none;
}

/* end mixins */

article.tariff {
  font-size:0.875em; /* 14px */
  padding-bottom:2em;
}

.tariff {
  a {
    color:#333;
    
    &:hover,
    &:focus {
      color:#2e8aca
    }
  }

  p {
    font-size:1em;
  }

  .inner {
    padding: 0;
  }
}

.help-notice {
  padding:0.25em 1em 0.25em 1em;
}

header.page-header {
  padding-bottom: 0;
  margin: 0;
  border-bottom: 0;

  hgroup {
    border-top-color: #7FB299;
    padding-bottom: 0;

    h1 {
      padding-left: 0;

      span {
        color: #10370D;
      }
    }
  }
}

#new_commodity_search {
  position: absolute;
  right: 0;
  top: 4.27em; /* 58px */
  background: #fff;
  width: 174px;
  padding: 5px 13px;
  font-size: 0.85em;

  a,
  .btn {
    margin-bottom:1em;
  }
  
  a,
  label {
    display:block;
  }
  
  .control-group {
    margin-bottom:0.75em;
  }
  
  input {
    margin-left:0;
  }
  
  .btn {
    background-color: #28a197;
    border-color: #28a197;    
  }
}

#commodity_search_q {
  width: 8em;
}

#index {
  list-style-type:upper-roman
}

article dl {
  padding: px($top-level-padding) px($top-level-padding) 0 px($top-level-padding);
  margin: 0;
  background: $top-section-grey;
  position: relative;
  
  dl {
    @include contain-float;
    margin-left:px($token-width - $top-level-padding);
    padding-top:0px;
  }
}

article dt {
  float: left;
  width: px($token-width);
  clear: left;
  text-align: center;
  display: block;
  font-size: 1em;
  position: absolute;
  left: 0;
  font-weight:normal;
  margin-bottom:0; /* reset of static */
}

dl.tariff-fragments {
  padding: 0;
  margin-left: -1px * $token-space;

  dt {
    @include tariff-identifier;
  }

  dd {
    float: none;
    padding-left: px($token-space);
    padding-top:1px; /* offset the border-bottom on the token */
    margin: 0;
  }

  dl {
    position: relative;
    margin-left:-1 * $token-padding;
    padding:0;
  }
}

article dd {
  float: left;
  display: block;
  margin: 0;
  padding-left: px($token-space - $top-level-padding);

  // this is so the children of this are cleared out left as the
  // internal content is pushed over by the float
  &.section-heading {
    width: auto;
    float: none;
    margin-bottom: 0;
  }
}

dl h1 {
  font-size: 100%;
  margin-top: 0;
  line-height: 1.5em;
  color: #333;
}

/* sections */

p.sections-intro {
  padding-left:0.5em;
  padding-right:1em;
}

dl.sections {
  background:#fff;
  
  dt {
    position:static;
    width:15%;
    padding-left:10%;
    text-align:left;
    font-weight:normal;
  }
}

dl.sections dd {
  width:75%;
  padding-left:0px;
}

/* chapters and chapter headings */

article.chapters dt {
  position:static;
  width:auto;
  margin-right:px($token-padding);
}

article.chapters dl.tariff-fragments dt {
  width:px($token-width);
}

dl.tariff-fragments dl.chapter-headings,
dl.chapters,
p.chapters-intro {
  margin-left:-1px * $token-space;
  @include selected-section($token-space);
}

dl.chapter-headings dt,
dl.chapters dt {
  left:px($token-space);
}

.chapter-notes {
  padding:0 px($top-level-padding) 0;
  width:auto;
  font-size:1em; /* 14px */
  
  h2,
  li {
    font-size:1em; /* 14px */
    margin-bottom:1em;
  }
  
  ol {
    list-style-type:decimal;
    margin-left:0;
    padding-left:em(($token-space - $top-level-padding), 14);
  }
  
  ol li {
    padding-left:0;
    margin-bottom:1em;
  }
  
  ol ol {
    padding-left:0;
    margin-top:1em;
  }
  
  ol ol li {
    list-style-type:lower-alpha;
  }
}

/* variables local to commodities */

$commodity-padding: ((2 * $token-space) + $token-padding) + $top-level-padding;
$expand-arrow-width: 9;
$expand-arrow-space: 9 + $token-padding;

/* end variables local to commodities */

ul.commodities,
ul.commodities ul {
  list-style:none;
}

ul.commodities {  
  @include selected-section($commodity-padding);
  
  li {
    display: block;
    margin: 0;
    @include contain-float;
    padding: 0;    

    span {
      font-size: 0.85em;
      float: left;
      display: block;

      &.identifier {
        @include tariff-identifier;
        float: right;
        border: 0;
        width: 4.5em;
        padding: 0 0.25em;
      }
    }

    a {
      display: block;
      @include contain-float;
    }
  }

  li:last-child {
    border-bottom: 0;
  }

  ul {
    margin: 0;
    padding-left: 2em;
    clear: both;
  }
}

dl.tariff-fragments dl.commodities {
  margin-left:0;
  padding-bottom:px($top-level-padding);
  
  dt {
    @include tariff-identifier-reset;
    width:auto;
    float:none;
    position:static;
    text-align:left;
    font-weight:normal;
  }
  
  span {
    float: left;
    display: block;

    &.identifier {
      @include tariff-identifier;
      padding: 0 0.25em;
      margin-right:5px;
      font-weight:bold;
    }
  }
}

.nav-tabs,
.tab-content {
  font-size:em(16, 14); /* 14px */
}

.nav-tabs {
  @include contain-float;
  background:$top-section-grey;
  @include tabs($token-width);
  
  li {
    padding:0;
    margin:0;
    font-size:1em;
  }
}

.tab-content {
  .tab-pane {
    border-top:solid 1px #C9D0D0;
    clear:both;
  }

  .inner {
    padding:0em 2.5em 1em;
  }

  p {
    font-size:1.1875em; /* 19px */
  }

  table {
    @include table;
    width:auto; /* override for static styles */
    margin:2em -1.375em 0; /* override for static styles - 32px 22px */
  }
  
  /* ignore caption */
  table thead,
  table tbody {
    font-size:0.75em; /* 12px */
  }
  
  table p {
    font-size:1em; /* 12px */
    width:55.4166664em; /* 665px */
    margin:0;
  }
  
  /* Expanding table-cell content */

  table dl {
    padding:0;
  }
  
  table dt {
    @include tariff-identifier-reset;
    width:auto;
    position:static;
    float:none;
    text-align:left;
  }
  
  table dd {
    float:none;
    padding-left:0;
  }
  
  dt.has_children {
    padding-left: px($expand-arrow-space);
    margin-left:-6px;
    background-image: url(<%= asset_path "expand-collapse-transparent.png" %>);
    background-position: 0px 2px;
    background-repeat: no-repeat;
  }
  
  dt.open {
    background-position:0 -89px;
  }
  
  table ul {
    list-style:none;
  }
  
  table li {
    font-size:1em;
    padding-left:0;
  }
  
  nav {
    margin:1em -1.375em 0; /* override for static styles - 16px 22px */
  }
}

/* Popup lightbox */

#popup.tariff-info {
  top: 12px;
  width: 560px;
  box-shadow: -0.5em 0.5em 0 rgba(0,0,0,0.3);
  padding:0;
  
  .info-content {
    background-color: #F27820;
    padding: 0 5px 5px 5px;
  }
  
  .info-inner {
    background-color: #FDE4D2;
    color: #000;
    padding: 1em 2em;
  }
  
  .close {
    right: 0.5em;
    top: 1.5em;
  }
  
  h2 {
    font-size: 2em;
    font-weight: normal;
    text-transform:uppercase;
    padding:0.2em 0 0 0.5em;
    color:#000;
  }
}

/* Search */

/* variables specific to search */

$results-padding: ((2 * $token-space) + $token-padding) + $top-level-padding;

/* end variables specific to search */

h1.search-heading,
article.search-results {
  padding: px($top-level-padding);
  width:auto;
}

h1.search-heading {
  background: $top-section-grey;
  color:#000;
  font-size:1em;
  font-weight:normal;
}

article.search-results {
  font-size:em(14, 16);
  
  h2 {
    clear:both;
    font-size:em(20, 16);
    margin-left:px($results-padding);
  }
  
  dl {
    position:relative;
    background:none;
    padding:0;
  }
  
  .results-subset {
    margin-left:px($results-padding);
    border-bottom:1px solid #eee;
  }
  
  dt {
    @include tariff-identifier;
  }
  
  dd,
  li {
    border-top:1px solid #eee;
  }
  
  dd {
    padding-left:px($token-space);
    float:none;
  }
  
  dd:nth-child(2),
  li:nth-child(1) {
    border-top:none;
    padding-top:1px;
  }
  
  dd a {
    text-decoration:none;
    display:block;
  }
  
  dl dl {
    margin-left:0;
  }
  
  dd dd {
    
  }
  
  li {
    font-size:1em; /* 14px */
    list-style:none;
  }
}

.js-enabled {
  li.has_children {
    
  }

  li.open {
    background-position: 0 -100px;
  }
  
  li.has_children .description {
    padding-left: px($expand-arrow-space);
    background-image: url(<%= asset_path "expand-collapse-transparent.png" %>);
    background-position: 0 7px;
    background-repeat: no-repeat;
  }
  
  li.has_children .open {
    background-position:0 -84px;
  }
  
  li.has_children a .description {
    padding-left:0;
    background:none;
  }
  
  .return-to-top {
    display:none;
  }
}