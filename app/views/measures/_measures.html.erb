<nav class="nav-tabs" role="navigation">
  <ul>
    <li class='active'>
      <a href="#overview" data-toggle="tab">Overview</a>
    </li>
    <li>
      <a href="#import" data-toggle="tab">Import</a>
    </li>
    <li>
      <a href="#export" data-toggle="tab">Export</a>
    </li>
    <li>
      <a href="#footnotes" data-toggle="tab">Footnotes</a>
    </li>
  </ul>
</nav>

<div id="measures-js" class='tab-content'>
  <article class='tab-pane active' id='overview'>
    <div class="inner">
      <h1 class="visuallyhidden">Overview</h1>
      <h2>Import</h2>
			<p>The commodity code for importing is <em><%= measurable.code %></em>.</p>
      <p>Importing from outside the EU is subject to a third country duty of <em><%= measurable.third_country_duty_rate %></em>.</p>
      <p> Goods are also subject to VAT standard rate of <em><%= measurable.uk_vat_rate %></em>.</p>
      <h2>Export</h2>
			<p>The commodity code for exporting and intrastat reporting is <em><%= measurable.display_export_code %></em>.</p>
      <p>Importing from outside the EU is subject to a third country duty of <em><%= measurable.third_country_duty_rate %></em>.</p>
      <!-- <h2>Export</h2>
      TODO: send count of export measures in the commoidity to do the check here
-->
      <div class="help-notice">
        <p> See <a href="#import">import</a> and <a href="#export">export</a> tables for country-specific measures and restrictions.</p>
      </div>
      <nav class="part-pagination return-to-top">
        <a href="#wrapper">Return to top &uarr;</a>
      </nav>
    </div>
  </article>
  <article class='tab-pane' id='import' data-id="<%= measurable.to_param %>" data-class="<%=measurable.class.name.downcase.pluralize %>">
    <div class="inner">
      <table>
        <caption>Third country measures:</caption>
        <thead>
          <tr>
            <th scope="col">&nbsp;</th>

            <th scope="col">Measure Type</th>

            <th scope="col">Duty rates / prohibitions</th>

            <th scope="col">Additional codes</th>

            <th scope="col">Conditions</th>

            <th scope="col">Exclusions</th>

            <th scope="col" class="legal-act external-link" title="Links open externally">Legal Act</th>

            <th scope="col">Footnote</th>
          </tr>
        </thead>

        <tbody>
          <% measurable.import_measures.select(&:third_country).group_by(&:geographical_area_type).each do |group, measures| %>
            <%= render partial: "measures/measure", collection: measures.sort_by(&:sort_key), locals: { measure_group: "third_country" } %>
          <% end %>
        </tbody>
      </table>

      <table>
        <caption>Measures for specific countries and country groups:</caption>
        <thead>
          <tr>
            <th>&nbsp;</th>

            <th>Country</th>

            <th>Measure Type</th>

            <th>Duty rates / prohibitions</th>

            <th>Additional codes</th>

            <th>Conditions</th>

            <th>Exclusions</th>

            <th class="legal-act external-link" title="Links open externally">Legal Act</th>

            <th>Footnotes</th>
          </tr>
        </thead>

        <tbody>
          <% measurable.import_measures.select(&:for_specific_countries).group_by(&:geographical_area_type).each do |group, measures| %>
            <%= render partial: "measures/measure", collection: measures.sort_by(&:geographical_area_description), locals: { measure_group: "specific_country" } %>
          <% end %>
        </tbody>
      </table>
      <nav class="part-pagination return-to-top">
        <a href="#wrapper">Return to top &uarr;</a>
      </nav>
    </div><!-- end .inner -->
  </article><!-- end .tab-pane -->
  <article class='tab-pane' id='export' data-id="<%= measurable.to_param %>" data-class="<%=measurable.class.name.downcase.pluralize %>">
    <div class="inner">
      <table>
        <caption>Third country measures:</caption>
        <thead>
          <tr>
            <th scope="col">&nbsp;</th>

            <th scope="col">Measure Type</th>

            <th scope="col">Duty rates / prohibitions</th>

            <th scope="col">Additional codes</th>

            <th scope="col">Conditions</th>

            <th scope="col">Exclusions</th>

            <th scope="col" class="legal-act external-link" title="Links open externally">Legal Act</th>

            <th scope="col">Footnote</th>
          </tr>
        </thead>

        <tbody>
          <% measurable.export_measures.select(&:third_country).group_by(&:geographical_area_type).each do |group, measures| %>
            <%= render partial: "measures/measure", collection: measures.sort_by(&:sort_key), locals: { measure_group: "third_country" } %>
          <% end %>
        </tbody>
      </table>

      <table>
        <thead>
          <tr>
            <th>&nbsp;</th>

            <th>Country</th>

            <th>Measure Type</th>

            <th>Duty rates / prohibitions</th>

            <th>Additional codes</th>

            <th>Conditions</th>

            <th>Exclusions</th>

            <th class="legal-act external-link" title="Links open externally">Legal Act</th>

            <th>Footnotes</th>
          </tr>
        </thead>

        <tbody>
          <% measurable.export_measures.select(&:for_specific_countries).group_by(&:geographical_area_type).each do |group, measures| %>
            <%= render partial: "measures/measure", collection: measures.sort_by(&:sort_key), locals: { measure_group: "specific_country" } %>
          <% end %>
        </tbody>
      </table>
      <nav class="part-pagination return-to-top">
        <a href="#wrapper">Return to top &uarr;</a>
      </nav>
    </div><!-- end .inner -->
  </article><!-- end .tab-pane -->
  <article class='tab-pane' id='footnotes' data-id="<%= measurable.to_param %>" data-class="<%=measurable.class.name.downcase.pluralize %>">
    <div class="inner">
      <table>
        <caption>Footnotes for commodity:</caption>
        <thead>
          <tr>
            <th>Code</th>

            <th>Description</th>
          </tr>
        </thead>

        <tbody>
          <%= render measurable.footnotes %>
        </tbody>
      </table>
      <nav class="part-pagination return-to-top">
        <a href="#wrapper">Return to top &uarr;</a>
      </nav>
    </div><!-- end .inner -->
  </article><!-- end .tab-pane -->
  <div class="inner">
    <% measurable.import_measures.select(&:third_country).group_by(&:geographical_area_type).each do |group, measures| %>
      <%= render partial: "measures/measure_references", collection: measures.sort_by(&:sort_key), as: 'measure', locals: { measure_group: "third_country" } %>
    <% end %>
    <% measurable.import_measures.select(&:for_specific_countries).group_by(&:geographical_area_type).each do |group, measures| %>
      <%= render partial: "measures/measure_references", collection: measures.sort_by(&:sort_key), as: 'measure', locals: { measure_group: "specific_country" } %>
    <% end %>
  </div>
  <div class="inner">
    <% measurable.export_measures.select(&:third_country).group_by(&:geographical_area_type).each do |group, measures| %>
      <%= render partial: "measures/measure_references", collection: measures.sort_by(&:sort_key), as: 'measure', locals: { measure_group: "third_country" } %>
    <% end %>
    <% measurable.export_measures.select(&:for_specific_countries).group_by(&:geographical_area_type).each do |group, measures| %>
      <%= render partial: "measures/measure_references", collection: measures.sort_by(&:sort_key), as: 'measure', locals: { measure_group: "specific_country" } %>
    <% end %>
  </div>
</div><!-- end .tab-content -->
